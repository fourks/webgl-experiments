<html>
<head>
  <title>WebGL 3D cube with Goraud interpolation (shading) and Lambertian reflection (lighting)</title>

  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

  <link rel="stylesheet" href="/stylesheets/screen.css" type="text/css">

  <script type="text/javascript" src="javascripts/lib/utils.js"></script>
  <script type="text/javascript" src="javascripts/lib/webgl-utils.js"></script>
  <script type="text/javascript" src="javascripts/lib/sylvester.src.js"></script>
  <script type="text/javascript" src="javascripts/lib/glUtils.js"></script>
  <script type="text/javascript" src="javascripts/application.js"></script>
  
  <!-- Vertex shader program -->
  <script id="shader-vs" type="x-shader/x-vertex">  
    attribute vec3 aVertexPosition;
    attribute vec3 aVertexNormal;
    attribute vec4 aVertexColor;
    
    uniform mat4 uNormalMatrix;
    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;
      
    uniform vec3 uLightDirection;   //light direction
    uniform vec4 uLightDiffuse;     //light color
    uniform vec4 uMaterialDiffuse;  //object color
      
    varying lowp vec4 vColor;
    
    void main(void) {
      //Transformed normal position
      vec3 N = normalize(vec3(uNormalMatrix * vec4(aVertexNormal, 1.0)));
    
      //Normalize light to calculate lambertTerm
      vec3 L = normalize(uLightDirection);
    
      //Lambert's cosine law
      float lambertTerm = dot(N,-L);
    
      //Final Color
      vec4 Id = aVertexColor * uLightDiffuse * lambertTerm;
      vColor = Id;
      vColor.a = 1.0;
      
      // vColor = aVertexColor;
    
      //Transformed vertex position
      gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
    }
  </script>

  <!-- Fragment shader program -->
  <script id="shader-fs" type="x-shader/x-fragment">
    #ifdef GL_ES
      precision highp float;
    #endif
    
    varying lowp vec4 vColor;

    void main(void) {
      gl_FragColor = vColor;
    }
  </script>
</head>
<body onload="start()">
  <canvas id="glcanvas" width="640" height="480">
    Your browser doesn't appear to support the HTML5 <code>&lt;canvas&gt;</code> element.
  </canvas>
</body>
</html>